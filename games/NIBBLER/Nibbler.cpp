///////////////////////////////////////////////////////////////////////////////
// Dependencies
///////////////////////////////////////////////////////////////////////////////
#include "games/NIBBLER/Nibbler.hpp"
#include "Arcade/core/API.hpp"
#include <iostream>

///////////////////////////////////////////////////////////////////////////////
// Namespace Arc
///////////////////////////////////////////////////////////////////////////////
namespace Arc
{

///////////////////////////////////////////////////////////////////////////////
Nibbler::Nibbler(void)
    : mGameOver(false)
{}

///////////////////////////////////////////////////////////////////////////////
Nibbler::~Nibbler()
{}

///////////////////////////////////////////////////////////////////////////////
void Nibbler::BeginPlay(void)
{
    API::PushEvent(API::Event::GRAPHICS, API::Event::GridSize({16, 16}));
}

///////////////////////////////////////////////////////////////////////////////
void Nibbler::EndPlay(void)
{}

///////////////////////////////////////////////////////////////////////////////
void Nibbler::Tick(float deltaSeconds)
{
    (void)deltaSeconds;
    while (std::optional event = API::PollEvent(API::Event::GAME)) {
        if (auto key = event->GetIf<API::Event::KeyPressed>()) {
            if (key->code == EKeyboardKey::G) {
                API::PushEvent(
                    API::Event::Channel::CORE,
                    API::Event::GameOver{200}
                );
                break;
            }
        }
    }
}

///////////////////////////////////////////////////////////////////////////////
bool Nibbler::IsGameOver(void) const
{
    return (mGameOver);
}

///////////////////////////////////////////////////////////////////////////////
int Nibbler::GetScore(void) const
{
    return (0);
}

///////////////////////////////////////////////////////////////////////////////
std::string Nibbler::GetName(void) const
{
    return ("Nibbler");
}

///////////////////////////////////////////////////////////////////////////////
std::string Nibbler::GetDescription(void) const
{
    return ("Nibbler is a snake game");
}

///////////////////////////////////////////////////////////////////////////////
std::string Nibbler::GetSpriteSheet(void) const
{
    return ("");
}

} // namespace Arc
