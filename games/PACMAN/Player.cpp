///////////////////////////////////////////////////////////////////////////////
// Dependencies
///////////////////////////////////////////////////////////////////////////////
#include "games/PACMAN/Player.hpp"
#include "Arcade/core/API.hpp"

///////////////////////////////////////////////////////////////////////////////
// Namespace Arc
///////////////////////////////////////////////////////////////////////////////
namespace Arc
{

///////////////////////////////////////////////////////////////////////////////
const Vec2i Player::STARTING_POSITION = Vec2i(14.f, 17.f);

///////////////////////////////////////////////////////////////////////////////
Player::Player(void)
    : mPosition(STARTING_POSITION)
    , mDirection(0.f)
    , mAccumulatedTime(0.f)
{}

///////////////////////////////////////////////////////////////////////////////
void Player::HandleEvents(void)
{}

///////////////////////////////////////////////////////////////////////////////
void Player::Update(float deltaSeconds)
{
    mAccumulatedTime += deltaSeconds;

    if (mAccumulatedTime >= 0.5f) {
        mAccumulatedTime = 0.0f;
    }
}

///////////////////////////////////////////////////////////////////////////////
void Player::Draw(void)
{
    int animationOffset = mAccumulatedTime < 0.25f ? 0 : 2;
    int directionOffset = 0;

    if (mDirection == Vec2i(0, 0)) {
        directionOffset = 0;
        animationOffset = 4;
    } else if (mDirection.x == 1) {
        directionOffset = 0;
    } else if (mDirection.x == -1) {
        directionOffset = 2;
    } else if (mDirection.y == 1) {
        directionOffset = 4;
    } else if (mDirection.y == -1) {
        directionOffset = 6;
    }

    API::Draw(PACMAN_XY(directionOffset, animationOffset), mPosition);
}

///////////////////////////////////////////////////////////////////////////////
Vec2i Player::GetPosition(void) const
{
    return (mPosition);
}

///////////////////////////////////////////////////////////////////////////////
Vec2i Player::GetDirection(void) const
{
    return (mDirection);
}

} // namespace Arc
